var mod_pagespeed__LgWeW$RTO = "var VocativGallery=Backbone.Model.extend({defaults:{pointer:0},initialize:function(){this.setPointer(this.get('pointer'));},isSingleton:function(){return this.get('images').length<=1;},setPointer:function(newPointer){newPointer=parseInt(newPointer);if(isNaN(newPointer)){newPointer=0;}newPointer=Math.min(this.get('images').length-1,newPointer);newPointer=Math.max(0,newPointer);if(this.get('pointer')!==newPointer)this.set('pointer',newPointer);},incrementPointer:function(){this.setPointer(this.get('pointer')+1);},decrementPointer:function(){this.setPointer(this.get('pointer')-1);},canDecrementPointer:function(){return this.get('pointer')>0;},canIncrementPointer:function(){return this.get('pointer')<this.get('images').length-1;},currImage:function(){return this.get('images')[this.get('pointer')];},getPostWatchGalleries:function(){var postWatch=this.get('postWatch');if(typeof postWatch!='undefined'){return postWatch.filter(function(gallery){return gallery.id!=this.id;},this);}return[];},hasPostWatch:function(){return this.getPostWatchGalleries().length>0;},choosePostWatchGallery:function(galleryId){var gallery=this.get('postWatch').find(function(gallery){return gallery.id==galleryId;});if(typeof gallery!='undefined'){gallery.set({pointer:0});this.trigger('change:vocativ-gallery',gallery);}}});var VocativGalleryGalleries=Backbone.Collection.extend();var VocativBaseGalleryView=Backbone.View.extend({initialize:function(options){this.id=VocativBaseGalleryView.nViews++;this.options=options||{};},assign:function(view,selector){view.setElement(this.$(selector)).render()},setupSharing:function(){var $iconList=this.$('.control-panel-top-sharing .share-icon-list');var currAtts=_.clone($iconList.get(0).attributes);for(var i=0;i<currAtts.length;i++){var attr=currAtts[i];if(attr.name!='class'){$iconList.removeAttr(attr.name);}}if(this.model.currImage()&&this.model.currImage().sharing_attributes){var shareAtts=this.model.currImage().sharing_attributes;for(var k in shareAtts){$iconList.attr('data-'+k,shareAtts[k]);}$iconList.data(shareAtts);$iconList.find('*[data-share-type]').off('click').on('click',_.bind(function(e){var shareType=jQuery(e.currentTarget).data('share-type');this.trigger('galleryEmbeddedShare',shareType);VocativTheme.socialShare(shareType,jQuery(e.currentTarget).get(0));},this));}}},{nViews:0});var VocativGalleryView=VocativBaseGalleryView.extend({events:{'click .gallery-top-controls .close-gallery':'close','click .gallery-top-controls .enlarge':'openZoom'},initialize:function(){VocativGalleryView.__super__.initialize.apply(this,arguments);if(this.options.tracker)this.options.tracker.register(this);this.slideView=new VocativGallerySlideView({model:this.model,tracker:this.options.tracker});if(!this.model.isSingleton()){this.thumbView=new VocativGalleryThumbView({model:this.model,tracker:this.options.tracker});}this.zoomView=null;jQuery(document).on('keyup.VocativGalleryView'+this.id,_.bind(this.keyup,this));this.listenTo(this.model,'change:vocativ-gallery',function(newGallery){this.close();var newView=new VocativGalleryView({model:newGallery});newView.render();jQuery('body').append(newView.$el);newView.open();});this.listenTo(Backbone,'close:vocativ-gallery',function(){this.close();});this.listenTo(this.model,'change:pointer',function(){this.setupSharing();});},stopListening:function(){VocativGalleryView.__super__.stopListening.apply(this,arguments);jQuery(document).off('keyup.VocativGalleryView'+this.id);},render:function(){this.$el.html(Vocativ.Templates['gallery-expanded']({singleton:this.model.isSingleton()}));if(jQuery('#wpadminbar').length>0)this.$('.vocativ-gallery-lightbox').addClass('w-admin-bar');this.assign(this.slideView,'.slide-view');if(!this.model.isSingleton())this.assign(this.thumbView,'.thumb-view');this.setupSharing();},open:function(){this.$el.show();this.render();},close:function(e){if(e)e.preventDefault();this.remove();this.stopListening();if(this.slideView){this.slideView.stopListening();this.slideView.remove();}if(this.thumbView){this.thumbView.stopListening();this.thumbView.remove();}if(this.postWatchView){this.postWatchView.stopListening();this.postWatchView.remove();}if(this.zoomView){this.zoomView.stopListening();this.zoomView.remove();this.zoomView.open=false;}this.trigger('close');},keyup:function(e){if(e.keyCode==27){if(this.zoomView&&this.zoomView.open){return;}this.close(e);}},openZoom:function(e){e.preventDefault();this.zoomView=new VocativGalleryZoomView({model:this.model});this.zoomView.render();jQuery('body').append(this.zoomView.$el);}});var VocativGalleryZoomView=VocativBaseGalleryView.extend({events:{'click .close':'closeParent','click .shrink':'close'},initialize:function(){VocativGalleryZoomView.__super__.initialize.apply(this,arguments);this.listenTo(this.model,'change',this.render);jQuery(document).on('keyup.VocativGalleryZoomView'+this.id,_.bind(this.keyup,this));jQuery(window).on('resize.VocativGalleryZoomView'+this.id,_.bind(this.render,this));jQuery(window).on('vocativ-gallery-post-watch.VocativGalleryZoomView'+this.id,_.bind(this.close,this));this.open=false;this.onLastSlide=false;},stopListening:function(){VocativGalleryZoomView.__super__.stopListening.apply(this,arguments);jQuery(document).off('keyup.VocativGalleryZoomView'+this.id);jQuery(window).off('resize.VocativGalleryZoomView'+this.id);jQuery(window).off('vocativ-gallery-post-watch.VocativGalleryZoomView'+this.id);},getRight:function($el){return(jQuery(window).width()-($el.offset().left+$el.outerWidth()));},getBottom:function($el){return jQuery(window).height()+jQuery(window).scrollTop()-$el.offset().top-$el.height();},render:function(){this.open=true;var currImage=this.model.currImage();this.$el.html(Vocativ.Templates['gallery-zoom']({numImages:this.model.get('images').length+(this.model.hasPostWatch()?1:0),singleton:this.model.isSingleton(),pointer:this.model.get('pointer'),caption:currImage.caption,credit:currImage.credit,url:this.getImageUrlForScreen(currImage)}));this.$('.image-wrapper .image-info').hover(_.bind(function(e){var $img=this.$('.image-wrapper img');var $caption=this.$('.image-info');$caption.css({left:$img.offset().left+'px',right:this.getRight($img)+'px',bottom:this.getBottom($img)+'px'});$caption.addClass('show');},this),_.bind(function(){var $caption=this.$('.image-info');$caption.removeClass('show');},this))\nthis.setupSharing();},getImageUrlForScreen:function(image){var w=jQuery(window).width();var h=jQuery(window).height();if(w<=300&&h<=300){return image.small;}if(w<=620&&h<=620){return image.medium;}if(w<=1024&&h<=1024){return image.large;}return image.zoom;},keyup:function(e){if(e.keyCode==27&&this.open){this.close(e);}},close:function(e){if(e){e.preventDefault();}this.stopListening();this.remove();this.open=false;},closeParent:function(e){view=this;view.close();Backbone.trigger('close:vocativ-gallery');}});var VocativGallerySlideView=VocativBaseGalleryView.extend({events:{'click .show-prev':'showPrev','click .show-next':'showNext','swipeRight .image-wrapper':'showPrev','swipeLeft .image-wrapper':'showNext','click .image-container img':'showNext','click .open-share-mobile':'showSharing','click .close-sharing':'hideSharing','mouseover .image-container img':'sharingHoverOn','mouseout .image-container img':'sharingHoverOff'},modelChange:function(){this.showPostWatch=false;this.render();},initialize:function(){VocativGallerySlideView.__super__.initialize.apply(this,arguments);if(this.options.tracker)this.options.tracker.register(this);this.listenTo(this.model,'change',this.modelChange);this.listenTo(this.model,'openPostWatch',_.bind(function(){this.showPostWatch=true;this.render();},this));jQuery(document).on('keyup.VocativGallerySlideView'+this.id,_.bind(this.keyup,this));jQuery(window).on('resize.VocativGallerySlideView'+this.id,_.bind(this.render,this));this.showPostWatch=false;},stopListening:function(){VocativGallerySlideView.__super__.stopListening.apply(this,arguments);jQuery(document).off('keyup.VocativGallerySlideView'+this.id);jQuery(window).off('resize.VocativGallerySlideView'+this.id);},prepImageView:function(view){view.render()},render:function(){this.hideImage();var currImage=this.model.currImage();this.$el.html(Vocativ.Templates['gallery-slide']({numImages:this.model.get('images').length+(this.model.hasPostWatch()?1:0),singleton:this.model.isSingleton(),pointer:this.model.get('pointer'),caption:currImage.caption,credit:currImage.credit,sharing:currImage.sharing,url:currImage.large,hasPostWatch:this.model.hasPostWatch(),showPostWatch:this.showPostWatch}));if(this.$('img')[0].complete){this.captionReposition();}else{this.$('img').load(_.bind(this.captionReposition,this));}if(typeof VocativTheme!='undefined'&&typeof VocativTheme.socialShare!='undefined'){var view=this;this.$('.share-icon-list *[data-share-type]').on('click',function(){var shareType=jQuery(this).data('share-type')\nVocativTheme.socialShare(shareType,this)\nview.trigger('imageshare',shareType,view.model);});}this.$('.post-watch').toggleClass('hidden',!this.showPostWatch);if(this.model.hasPostWatch()&&this.showPostWatch){this.postWatchView=new VocativPostWatchView({model:this.model,tracker:this.options.tracker});this.assign(this.postWatchView,'.post-watch-inner');if(typeof jQuery.fn.ellipsis!='undefined')this.$('.post-watch-inner .post-watch-gallery .title').ellipsis();jQuery(window).trigger('vocativ-gallery-post-watch');}else if(this.postWatchView){this.postWatchView.el=null;this.postWatchView.stopListening();this.$('.post-watch-inner').html('');}this.$el.parents().toggleClass('vocativ-gallery-show-postwatch',this.showPostWatch);},hideImage:function(){this.$('.image-container').addClass('loading');},showImage:function(){this.$('.image-container').removeClass('loading');},captionReposition:function(){var $img=this.$('img');var $container=this.$('.image-container');var $caption=this.$('.image-info');$caption.width(Math.min($img.width(),$container.width()-10));var containerBottom=$container.offset().top+$container.height();var captionBottom=$caption.offset().top+$caption.height();var diff=captionBottom-containerBottom;if(diff<=0){this.$('.image-wrapper').css('margin-top',(-diff/2)+'px');this.$('.sharing').width($img.width()).offset($img.offset()).show();this.showImage();return;}$img.height(Math.max(0,$img.height()-(diff)));if(!$img.height()){this.$('.image-wrapper').hide();this.$('.prev-link,.next-link').appendTo($container);$caption.width($container.width()-10);var heightDiff=$container.height()-$caption.height();if(heightDiff>0)$container.css('padding-top',(heightDiff/2)+'px');this.showImage();return;}this.captionReposition();},showNext:function(){if(!this.model.canIncrementPointer()&&this.model.hasPostWatch()){this.model.trigger('openPostWatch');}else{this.trigger('showNext',this.model);this.model.incrementPointer();}},showPrev:function(){this.trigger('showPrev',this.model);this.model.decrementPointer();},showSharing:function(e){e.preventDefault();this.$('.sharing').addClass('open');},hideSharing:function(e){e.preventDefault();this.$('.sharing').removeClass('open');},sharingHoverOn:function(){this.$('.sharing').addClass('hover');},sharingHoverOff:function(){this.$('.sharing').removeClass('hover');},keyup:function(event){if(event.keyCode==39){this.showNext()}if(event.keyCode==37){this.showPrev()}}})\nvar VocativGalleryThumbView=VocativBaseGalleryView.extend({events:{'click .images li':'selectImage','click .show-prev':'showPrev','click .show-next':'showNext','swipeRight .images':'showPrev','swipeLeft .images':'showNext'},initialize:function(){VocativGalleryThumbView.__super__.initialize.apply(this,arguments);if(this.options.tracker)this.options.tracker.register(this);this.listenTo(this.model,'change',this.render);this.listenTo(this.model,'change:vocativ-gallery',function(newGallery){this.$('ul.images').empty();var $newEl=this.$el.clone();this.$el.replaceWith($newEl);new VocativGalleryThumbView({el:$newEl.get(0),model:newGallery}).render();this.remove();this.stopListening();});jQuery(window).on('resize.VocativGalleryThumbView'+this.id,_.bind(this.scrollIntoView,this));},stopListening:function(){VocativGallerySlideView.__super__.stopListening.apply(this,arguments);jQuery(window).off('resize.VocativGalleryThumbView'+this.id);},getRight:function($el){return(jQuery(window).width()-($el.offset().left+$el.outerWidth()));},render:function(){if(!this.$('ul.images li').length){this.$el.html(Vocativ.Templates['gallery-thumb']({images:this.model.get('images'),pointer:this.model.get('pointer'),l10n:VocativGalleryL10n}));}this.$('li.active').removeClass('active');var $activeItem=jQuery(this.$('li.image').get(this.model.get('pointer')));$activeItem.addClass('active');this.$('.show-next').toggle(this.model.canIncrementPointer()||this.model.hasPostWatch());this.$('.show-prev').toggle(this.model.canDecrementPointer());this.scrollIntoView();},scrollIntoView:function(){var $activeItem=jQuery(this.$('li.image').get(this.model.get('pointer')));if(!$activeItem.length)return;var activeRight=this.getRight($activeItem);var $wrapper=this.$('.images-wrapper-inner');var wrapperRight=this.getRight($wrapper);if(wrapperRight>activeRight){var $images=this.$('ul.images');var currLeft=parseInt($images.css('left').replace('px',''));var newLeft=currLeft+activeRight-wrapperRight;$images.css('left',newLeft+'px');}var activeLeft=$activeItem.offset().left;var wrapperLeft=$wrapper.offset().left;if(wrapperLeft>activeLeft){var $images=this.$('ul.images');var currLeft=parseInt($images.css('left').replace('px',''));var newLeft=currLeft+wrapperLeft-activeLeft;$images.css('left',newLeft+'px');}},selectImage:function(e){e.preventDefault();var $li=jQuery(e.target).closest('li');var idx=$li.data('idx');this.trigger('galleryEmbeddedClickPicture',idx,this.model.get('images').length);this.model.setPointer(idx);},showNext:function(){if(this.model.canIncrementPointer()){this.trigger('showNext',this.model);this.model.incrementPointer();}else if(this.model.hasPostWatch()){this.model.trigger('openPostWatch');}},showPrev:function(){this.trigger('showPrev',this.model);this.model.decrementPointer();}})\nvar VocativGalleryEmbeddedView=VocativBaseGalleryView.extend({events:{'click .fullscreen':'fullScreen','click .prev-link':'showPrev','click .next-link':'showNext',},modelChange:function(){this.showPostWatch=false;this.render();if(!this.model.get('mainGallery'))return;var browser_is_ie=!!navigator.userAgent.match(/MSIE /)||!!navigator.userAgent.match(/Trident.*rv[ :]*11\\./);if(!browser_is_ie){var new_url=jQuery(document).attr('location').origin+jQuery(document).attr('location').pathname;var slide_matcher=new RegExp(\"/slide[0-9]{1,}/?\");var slide_position=new_url.search(slide_matcher);if(this.model.get('pointer')==0){if(slide_position>-1){new_url=new_url.substring(0,slide_position+1);}}else{if(slide_position>-1){new_url=new_url.replace(slide_matcher,\"/slide\"+this.model.get('pointer').toString()+\"/\");}else{if(new_url.slice(-1)!=\"/\"){new_url+=\"/\";}new_url+=\"slide\"+this.model.get('pointer').toString()+\"/\";}}var title=jQuery(document).attr('title');new_url=new_url+(jQuery(document).attr('location').search||'')+(jQuery(document).attr('location').hash||'');if(document.URL!=new_url){window.history.pushState({model_id:this.model.get('id'),pointer:this.model.get('pointer')},title,new_url);}}},initialize:function(){VocativGalleryEmbeddedView.__super__.initialize.apply(this,arguments);this.listenTo(this.model,'change',this.modelChange);this.listenTo(this.model,'change:vocativ-gallery',function(newGallery){var $newEl=this.$el.clone();this.$el.replaceWith($newEl);new VocativGalleryEmbeddedView({el:$newEl.get(0),model:newGallery}).render();this.remove();this.stopListening();});this.listenTo(this.model,'openPostWatch',_.bind(function(){this.showPostWatch=true;this.render();},this));this.showPostWatch=false;if(this.options.tracker)this.options.tracker.register(this);},render:function(){var imgSrc=null;if(this.model.get('mainGallery'))imgSrc=this.model.currImage().large;else\nimgSrc=this.model.currImage().medium;this.$('img:first').attr('src',imgSrc);var nImages=this.model.get('images').length+(this.model.hasPostWatch()?1:0);this.$('.curr-position').text(this.showPostWatch?nImages:this.model.get('pointer')+1);this.$('.n-images').text(nImages);this.$('.gallery-caption').html(this.model.currImage().caption);this.$('.gallery-credit').text(this.model.currImage().credit);this.$('.next-link').toggleClass('hidden',!this.model.canIncrementPointer()&&!this.model.hasPostWatch())\nthis.$('.prev-link').toggleClass('hidden',!this.model.canDecrementPointer());this.$('.loading').removeClass('hidden');if(this.$('img:first')[0].complete){this.$('.loading').addClass('hidden');}else{this.$('img:first').load(_.bind(function(){this.$('.loading').addClass('hidden');},this));}this.$('.post-watch').toggleClass('hidden',!this.showPostWatch);if(this.model.hasPostWatch()&&this.showPostWatch){this.postWatchView=new VocativPostWatchView({model:this.model,tracker:this.options.tracker});this.assign(this.postWatchView,'.post-watch');if(typeof jQuery.fn.ellipsis!='undefined')this.$('.post-watch .post-watch-gallery .title').ellipsis();this.$('.post-watch .post-watch-gallery').click(_.bind(function(e){var pathname=document.location.pathname;if(pathname.slice(-1)==\"/\"){pathname=pathname.slice(0,-1);}pathname=pathname.substring(0,pathname.lastIndexOf('/'));var destination=jQuery(e.target).closest('.post-watch-gallery').attr('href');if(destination){destination='/'+destination.replace(/^(?:\\/\\/|[^\\/]+)*\\//,\"\").split('?')[0];}var position=jQuery(e.target).closest('li').index()+1;this.trigger('postWatch',pathname,destination,position.toString());},this));}else if(this.postWatchView){this.postWatchView.el=null;this.postWatchView.stopListening();this.$('.post-watch').html('');}this.$el.closest('.gallery-view').toggleClass('vocativ-gallery-show-postwatch',this.showPostWatch);},fullScreen:function(e){e.preventDefault();var galleryView=new VocativGalleryView({model:this.model,tracker:this.options.tracker});jQuery('body').append(galleryView.$el);galleryView.render();this.trigger('open');},showNext:function(e){e.preventDefault();if(!this.model.canIncrementPointer()&&this.model.hasPostWatch()){this.model.trigger('openPostWatch');}else{this.trigger('showNext',this.model);this.model.incrementPointer();}},showPrev:function(e){e.preventDefault();this.trigger('showPrev',this.model);this.model.decrementPointer();}});var VocativPostWatchView=VocativBaseGalleryView.extend({events:{'click .post-watch-gallery':'chooseGallery','click .replay':'replay'},initialize:function(){VocativPostWatchView.__super__.initialize.apply(this,arguments);if(this.options.tracker)this.options.tracker.register(this);},render:function(){this.$el.html(Vocativ.Templates['gallery-post-watch']({galleries:this.model.getPostWatchGalleries(),sharing:this.model.get('sharing'),l10n:VocativGalleryL10n}));if(typeof this.model.get('sharing')!='undefined'){if(this.$('.sharing').is(':visible')){if(typeof FB!='undefined')FB.XFBML.parse();if(typeof twttr!='undefined')twttr.widgets.load();var view=this;if(typeof VocativTheme!='undefined'&&typeof VocativTheme.socialShare!='undefined'){this.$('.fb-vocativ-share-button').click(function(){var shareType=jQuery(this).data('share-type')\nVocativTheme.socialShare(shareType,this)\nview.trigger('fbShare');});}}}},chooseGallery:function(e){if(this.model.get('mainGallery'))return;e.preventDefault();var newGalleryId=jQuery(e.target).closest('.post-watch-gallery').data('id');this.model.choosePostWatchGallery(newGalleryId);},replay:function(e){e.preventDefault();this.model.set({pointer:0});}});";
var mod_pagespeed_9AcZwOU3JB = ";(function($){$.flexslider=function(el,options){var slider=$(el);slider.vars=$.extend({},$.flexslider.defaults,options);var namespace=slider.vars.namespace,msGesture=window.navigator&&window.navigator.msPointerEnabled&&window.MSGesture,touch=((\"ontouchstart\"in window)||msGesture||window.DocumentTouch&&document instanceof DocumentTouch)&&slider.vars.touch,eventType=\"click touchend MSPointerUp\",watchedEvent=\"\",watchedEventClearTimer,vertical=slider.vars.direction===\"vertical\",reverse=slider.vars.reverse,carousel=(slider.vars.itemWidth>0),fade=slider.vars.animation===\"fade\",asNav=slider.vars.asNavFor!==\"\",methods={},focused=true;$.data(el,\"flexslider\",slider);methods={init:function(){slider.animating=false;slider.currentSlide=parseInt((slider.vars.startAt?slider.vars.startAt:0));if(isNaN(slider.currentSlide))slider.currentSlide=0;slider.animatingTo=slider.currentSlide;slider.atEnd=(slider.currentSlide===0||slider.currentSlide===slider.last);slider.containerSelector=slider.vars.selector.substr(0,slider.vars.selector.search(' '));slider.slides=$(slider.vars.selector,slider);slider.container=$(slider.containerSelector,slider);slider.count=slider.slides.length;slider.syncExists=$(slider.vars.sync).length>0;if(slider.vars.animation===\"slide\")slider.vars.animation=\"swing\";slider.prop=(vertical)?\"top\":\"marginLeft\";slider.args={};slider.manualPause=false;slider.stopped=false;slider.started=false;slider.startTimeout=null;slider.transitions=!slider.vars.video&&!fade&&slider.vars.useCSS&&(function(){var obj=document.createElement('div'),props=['perspectiveProperty','WebkitPerspective','MozPerspective','OPerspective','msPerspective'];for(var i in props){if(obj.style[props[i]]!==undefined){slider.pfx=props[i].replace('Perspective','').toLowerCase();slider.prop=\"-\"+slider.pfx+\"-transform\";return true;}}return false;}());if(slider.vars.controlsContainer!==\"\")slider.controlsContainer=$(slider.vars.controlsContainer).length>0&&$(slider.vars.controlsContainer);if(slider.vars.manualControls!==\"\")slider.manualControls=$(slider.vars.manualControls).length>0&&$(slider.vars.manualControls);if(slider.vars.randomize){slider.slides.sort(function(){return(Math.round(Math.random())-0.5);});slider.container.empty().append(slider.slides);}slider.doMath();slider.setup(\"init\");if(slider.vars.controlNav)methods.controlNav.setup();if(slider.vars.directionNav)methods.directionNav.setup();if(slider.vars.keyboard&&($(slider.containerSelector).length===1||slider.vars.multipleKeyboard)){$(document).bind('keyup',function(event){var keycode=event.keyCode;if(!slider.animating&&(keycode===39||keycode===37)){var target=(keycode===39)?slider.getTarget('next'):(keycode===37)?slider.getTarget('prev'):false;slider.flexAnimate(target,slider.vars.pauseOnAction);}});}if(slider.vars.mousewheel){slider.bind('mousewheel',function(event,delta,deltaX,deltaY){event.preventDefault();var target=(delta<0)?slider.getTarget('next'):slider.getTarget('prev');slider.flexAnimate(target,slider.vars.pauseOnAction);});}if(slider.vars.pausePlay)methods.pausePlay.setup();if(slider.vars.slideshow&&slider.vars.pauseInvisible)methods.pauseInvisible.init();if(slider.vars.slideshow){if(slider.vars.pauseOnHover){slider.hover(function(){if(!slider.manualPlay&&!slider.manualPause)slider.pause();},function(){if(!slider.manualPause&&!slider.manualPlay&&!slider.stopped)slider.play();});}if(!slider.vars.pauseInvisible||!methods.pauseInvisible.isHidden()){(slider.vars.initDelay>0)?slider.startTimeout=setTimeout(slider.play,slider.vars.initDelay):slider.play();}}if(asNav)methods.asNav.setup();if(touch&&slider.vars.touch)methods.touch();if(!fade||(fade&&slider.vars.smoothHeight))$(window).bind(\"resize orientationchange focus\",methods.resize);slider.find(\"img\").attr(\"draggable\",\"false\");setTimeout(function(){slider.vars.start(slider);},200);},asNav:{setup:function(){slider.asNav=true;slider.animatingTo=Math.floor(slider.currentSlide/slider.move);slider.currentItem=slider.currentSlide;slider.slides.removeClass(namespace+\"active-slide\").eq(slider.currentItem).addClass(namespace+\"active-slide\");if(!msGesture){slider.slides.click(function(e){e.preventDefault();var $slide=$(this),target=$slide.index();var posFromLeft=$slide.offset().left-$(slider).scrollLeft();if(posFromLeft<=0&&$slide.hasClass(namespace+'active-slide')){slider.flexAnimate(slider.getTarget(\"prev\"),true);}else if(!$(slider.vars.asNavFor).data('flexslider').animating&&!$slide.hasClass(namespace+\"active-slide\")){slider.direction=(slider.currentItem<target)?\"next\":\"prev\";slider.flexAnimate(target,slider.vars.pauseOnAction,false,true,true);}});}else{el._slider=slider;slider.slides.each(function(){var that=this;that._gesture=new MSGesture();that._gesture.target=that;that.addEventListener(\"MSPointerDown\",function(e){e.preventDefault();if(e.currentTarget._gesture)e.currentTarget._gesture.addPointer(e.pointerId);},false);that.addEventListener(\"MSGestureTap\",function(e){e.preventDefault();var $slide=$(this),target=$slide.index();if(!$(slider.vars.asNavFor).data('flexslider').animating&&!$slide.hasClass('active')){slider.direction=(slider.currentItem<target)?\"next\":\"prev\";slider.flexAnimate(target,slider.vars.pauseOnAction,false,true,true);}});});}}},controlNav:{setup:function(){if(!slider.manualControls){methods.controlNav.setupPaging();}else{methods.controlNav.setupManual();}},setupPaging:function(){var type=(slider.vars.controlNav===\"thumbnails\")?'control-thumbs':'control-paging',j=1,item,slide;slider.controlNavScaffold=$('<ol class=\"'+namespace+'control-nav '+namespace+type+'\"></ol>');if(slider.pagingCount>1){for(var i=0;i<slider.pagingCount;i++){slide=slider.slides.eq(i);item=(slider.vars.controlNav===\"thumbnails\")?'<img src=\"'+slide.attr('data-thumb')+'\"/>':'<a>'+j+'</a>';if('thumbnails'===slider.vars.controlNav&&true===slider.vars.thumbCaptions){var captn=slide.attr('data-thumbcaption');if(''!=captn&&undefined!=captn)item+='<span class=\"'+namespace+'caption\">'+captn+'</span>';}slider.controlNavScaffold.append('<li>'+item+'</li>');j++;}}(slider.controlsContainer)?$(slider.controlsContainer).append(slider.controlNavScaffold):slider.append(slider.controlNavScaffold);methods.controlNav.set();methods.controlNav.active();slider.controlNavScaffold.delegate('a, img',eventType,function(event){event.preventDefault();if(watchedEvent===\"\"||watchedEvent===event.type){var $this=$(this),target=slider.controlNav.index($this);if(!$this.hasClass(namespace+'active')){slider.direction=(target>slider.currentSlide)?\"next\":\"prev\";slider.flexAnimate(target,slider.vars.pauseOnAction);}}if(watchedEvent===\"\"){watchedEvent=event.type;}methods.setToClearWatchedEvent();});},setupManual:function(){slider.controlNav=slider.manualControls;methods.controlNav.active();slider.controlNav.bind(eventType,function(event){event.preventDefault();if(watchedEvent===\"\"||watchedEvent===event.type){var $this=$(this),target=slider.controlNav.index($this);if(!$this.hasClass(namespace+'active')){(target>slider.currentSlide)?slider.direction=\"next\":slider.direction=\"prev\";slider.flexAnimate(target,slider.vars.pauseOnAction);}}if(watchedEvent===\"\"){watchedEvent=event.type;}methods.setToClearWatchedEvent();});},set:function(){var selector=(slider.vars.controlNav===\"thumbnails\")?'img':'a';slider.controlNav=$('.'+namespace+'control-nav li '+selector,(slider.controlsContainer)?slider.controlsContainer:slider);},active:function(){slider.controlNav.removeClass(namespace+\"active\").eq(slider.animatingTo).addClass(namespace+\"active\");},update:function(action,pos){if(slider.pagingCount>1&&action===\"add\"){slider.controlNavScaffold.append($('<li><a>'+slider.count+'</a></li>'));}else if(slider.pagingCount===1){slider.controlNavScaffold.find('li').remove();}else{slider.controlNav.eq(pos).closest('li').remove();}methods.controlNav.set();(slider.pagingCount>1&&slider.pagingCount!==slider.controlNav.length)?slider.update(pos,action):methods.controlNav.active();}},directionNav:{setup:function(){var directionNavScaffold=$('<ul class=\"'+namespace+'direction-nav\"><li><a class=\"'+namespace+'prev\" href=\"#\">'+slider.vars.prevText+'</a></li><li><a class=\"'+namespace+'next\" href=\"#\">'+slider.vars.nextText+'</a></li></ul>');if(slider.controlsContainer){$(slider.controlsContainer).append(directionNavScaffold);slider.directionNav=$('.'+namespace+'direction-nav li a',slider.controlsContainer);}else{slider.append(directionNavScaffold);slider.directionNav=$('.'+namespace+'direction-nav li a',slider);}methods.directionNav.update();slider.directionNav.bind(eventType,function(event){event.preventDefault();var target;if(watchedEvent===\"\"||watchedEvent===event.type){target=($(this).hasClass(namespace+'next'))?slider.getTarget('next'):slider.getTarget('prev');slider.flexAnimate(target,slider.vars.pauseOnAction);}if(watchedEvent===\"\"){watchedEvent=event.type;}methods.setToClearWatchedEvent();});},update:function(){var disabledClass=namespace+'disabled';if(slider.pagingCount===1){slider.directionNav.addClass(disabledClass).attr('tabindex','-1');}else if(!slider.vars.animationLoop){if(slider.animatingTo===0){slider.directionNav.removeClass(disabledClass).filter('.'+namespace+\"prev\").addClass(disabledClass).attr('tabindex','-1');}else if(slider.animatingTo===slider.last){slider.directionNav.removeClass(disabledClass).filter('.'+namespace+\"next\").addClass(disabledClass).attr('tabindex','-1');}else{slider.directionNav.removeClass(disabledClass).removeAttr('tabindex');}}else{slider.directionNav.removeClass(disabledClass).removeAttr('tabindex');}}},pausePlay:{setup:function(){var pausePlayScaffold=$('<div class=\"'+namespace+'pauseplay\"><a></a></div>');if(slider.controlsContainer){slider.controlsContainer.append(pausePlayScaffold);slider.pausePlay=$('.'+namespace+'pauseplay a',slider.controlsContainer);}else{slider.append(pausePlayScaffold);slider.pausePlay=$('.'+namespace+'pauseplay a',slider);}methods.pausePlay.update((slider.vars.slideshow)?namespace+'pause':namespace+'play');slider.pausePlay.bind(eventType,function(event){event.preventDefault();if(watchedEvent===\"\"||watchedEvent===event.type){if($(this).hasClass(namespace+'pause')){slider.manualPause=true;slider.manualPlay=false;slider.pause();}else{slider.manualPause=false;slider.manualPlay=true;slider.play();}}if(watchedEvent===\"\"){watchedEvent=event.type;}methods.setToClearWatchedEvent();});},update:function(state){(state===\"play\")?slider.pausePlay.removeClass(namespace+'pause').addClass(namespace+'play').html(slider.vars.playText):slider.pausePlay.removeClass(namespace+'play').addClass(namespace+'pause').html(slider.vars.pauseText);}},touch:function(){var startX,startY,offset,cwidth,dx,startT,scrolling=false,localX=0,localY=0,accDx=0;if(!msGesture){el.addEventListener('touchstart',onTouchStart,false);function onTouchStart(e){if(slider.animating){e.preventDefault();}else if((window.navigator.msPointerEnabled)||e.touches.length===1){slider.pause();cwidth=(vertical)?slider.h:slider.w;startT=Number(new Date());localX=e.touches[0].pageX;localY=e.touches[0].pageY;offset=(carousel&&reverse&&slider.animatingTo===slider.last)?0:(carousel&&reverse)?slider.limit-(((slider.itemW+slider.vars.itemMargin)*slider.move)*slider.animatingTo):(carousel&&slider.currentSlide===slider.last)?slider.limit:(carousel)?((slider.itemW+slider.vars.itemMargin)*slider.move)*slider.currentSlide:(reverse)?(slider.last-slider.currentSlide+slider.cloneOffset)*cwidth:(slider.currentSlide+slider.cloneOffset)*cwidth;startX=(vertical)?localY:localX;startY=(vertical)?localX:localY;el.addEventListener('touchmove',onTouchMove,false);el.addEventListener('touchend',onTouchEnd,false);}}function onTouchMove(e){localX=e.touches[0].pageX;localY=e.touches[0].pageY;dx=(vertical)?startX-localY:startX-localX;scrolling=(vertical)?(Math.abs(dx)<Math.abs(localX-startY)):(Math.abs(dx)<Math.abs(localY-startY));var fxms=500;if(!scrolling||Number(new Date())-startT>fxms){e.preventDefault();if(!fade&&slider.transitions){if(!slider.vars.animationLoop){dx=dx/((slider.currentSlide===0&&dx<0||slider.currentSlide===slider.last&&dx>0)?(Math.abs(dx)/cwidth+2):1);}slider.setProps(offset+dx,\"setTouch\");}}}function onTouchEnd(e){el.removeEventListener('touchmove',onTouchMove,false);if(slider.animatingTo===slider.currentSlide&&!scrolling&&!(dx===null)){var updateDx=(reverse)?-dx:dx,target=(updateDx>0)?slider.getTarget('next'):slider.getTarget('prev');if(slider.canAdvance(target)&&(Number(new Date())-startT<550&&Math.abs(updateDx)>50||Math.abs(updateDx)>cwidth/2)){slider.flexAnimate(target,slider.vars.pauseOnAction);}else{if(!fade)slider.flexAnimate(slider.currentSlide,slider.vars.pauseOnAction,true);}}el.removeEventListener('touchend',onTouchEnd,false);startX=null;startY=null;dx=null;offset=null;}}else{el.style.msTouchAction=\"none\";el._gesture=new MSGesture();el._gesture.target=el;el.addEventListener(\"MSPointerDown\",onMSPointerDown,false);el._slider=slider;el.addEventListener(\"MSGestureChange\",onMSGestureChange,false);el.addEventListener(\"MSGestureEnd\",onMSGestureEnd,false);function onMSPointerDown(e){e.stopPropagation();if(slider.animating){e.preventDefault();}else{slider.pause();el._gesture.addPointer(e.pointerId);accDx=0;cwidth=(vertical)?slider.h:slider.w;startT=Number(new Date());offset=(carousel&&reverse&&slider.animatingTo===slider.last)?0:(carousel&&reverse)?slider.limit-(((slider.itemW+slider.vars.itemMargin)*slider.move)*slider.animatingTo):(carousel&&slider.currentSlide===slider.last)?slider.limit:(carousel)?((slider.itemW+slider.vars.itemMargin)*slider.move)*slider.currentSlide:(reverse)?(slider.last-slider.currentSlide+slider.cloneOffset)*cwidth:(slider.currentSlide+slider.cloneOffset)*cwidth;}}function onMSGestureChange(e){e.stopPropagation();var slider=e.target._slider;if(!slider){return;}var transX=-e.translationX,transY=-e.translationY;accDx=accDx+((vertical)?transY:transX);dx=accDx;scrolling=(vertical)?(Math.abs(accDx)<Math.abs(-transX)):(Math.abs(accDx)<Math.abs(-transY));if(e.detail===e.MSGESTURE_FLAG_INERTIA){setImmediate(function(){el._gesture.stop();});return;}if(!scrolling||Number(new Date())-startT>500){e.preventDefault();if(!fade&&slider.transitions){if(!slider.vars.animationLoop){dx=accDx/((slider.currentSlide===0&&accDx<0||slider.currentSlide===slider.last&&accDx>0)?(Math.abs(accDx)/cwidth+2):1);}slider.setProps(offset+dx,\"setTouch\");}}}function onMSGestureEnd(e){e.stopPropagation();var slider=e.target._slider;if(!slider){return;}if(slider.animatingTo===slider.currentSlide&&!scrolling&&!(dx===null)){var updateDx=(reverse)?-dx:dx,target=(updateDx>0)?slider.getTarget('next'):slider.getTarget('prev');if(slider.canAdvance(target)&&(Number(new Date())-startT<550&&Math.abs(updateDx)>50||Math.abs(updateDx)>cwidth/2)){slider.flexAnimate(target,slider.vars.pauseOnAction);}else{if(!fade)slider.flexAnimate(slider.currentSlide,slider.vars.pauseOnAction,true);}}startX=null;startY=null;dx=null;offset=null;accDx=0;}}},resize:function(){if(!slider.animating&&slider.is(':visible')){if(!carousel)slider.doMath();if(fade){methods.smoothHeight();}else if(carousel){slider.slides.width(slider.computedW);slider.update(slider.pagingCount);slider.setProps();}else if(vertical){slider.viewport.height(slider.h);slider.setProps(slider.h,\"setTotal\");}else{if(slider.vars.smoothHeight)methods.smoothHeight();slider.newSlides.width(slider.computedW);slider.setProps(slider.computedW,\"setTotal\");}}},smoothHeight:function(dur){if(!vertical||fade){var $obj=(fade)?slider:slider.viewport;(dur)?$obj.animate({\"height\":slider.slides.eq(slider.animatingTo).height()},dur):$obj.height(slider.slides.eq(slider.animatingTo).height());}},sync:function(action){var $obj=$(slider.vars.sync).data(\"flexslider\"),target=slider.animatingTo;switch(action){case\"animate\":$obj.flexAnimate(target,slider.vars.pauseOnAction,false,true);break;case\"play\":if(!$obj.playing&&!$obj.asNav){$obj.play();}break;case\"pause\":$obj.pause();break;}},pauseInvisible:{visProp:null,init:function(){var prefixes=['webkit','moz','ms','o'];if('hidden'in document)return'hidden';for(var i=0;i<prefixes.length;i++){if((prefixes[i]+'Hidden')in document)methods.pauseInvisible.visProp=prefixes[i]+'Hidden';}if(methods.pauseInvisible.visProp){var evtname=methods.pauseInvisible.visProp.replace(/[H|h]idden/,'')+'visibilitychange';document.addEventListener(evtname,function(){if(methods.pauseInvisible.isHidden()){if(slider.startTimeout)clearTimeout(slider.startTimeout);else slider.pause();}else{if(slider.started)slider.play();else(slider.vars.initDelay>0)?setTimeout(slider.play,slider.vars.initDelay):slider.play();}});}},isHidden:function(){return document[methods.pauseInvisible.visProp]||false;}},setToClearWatchedEvent:function(){clearTimeout(watchedEventClearTimer);watchedEventClearTimer=setTimeout(function(){watchedEvent=\"\";},3000);}}\nslider.flexAnimate=function(target,pause,override,withSync,fromNav){if(!slider.vars.animationLoop&&target!==slider.currentSlide){slider.direction=(target>slider.currentSlide)?\"next\":\"prev\";}if(asNav&&slider.pagingCount===1)slider.direction=(slider.currentItem<target)?\"next\":\"prev\";if(!slider.animating&&(slider.canAdvance(target,fromNav)||override)&&slider.is(\":visible\")){if(asNav&&withSync){var master=$(slider.vars.asNavFor).data('flexslider');slider.atEnd=target===0||target===slider.count-1;master.flexAnimate(target,true,false,true,fromNav);slider.direction=(slider.currentItem<target)?\"next\":\"prev\";master.direction=slider.direction;if(Math.ceil((target+1)/slider.visible)-1!==slider.currentSlide&&target!==0){slider.currentItem=target;slider.slides.removeClass(namespace+\"active-slide\").eq(target).addClass(namespace+\"active-slide\");target=Math.floor(target/slider.visible);}else{slider.currentItem=target;slider.slides.removeClass(namespace+\"active-slide\").eq(target).addClass(namespace+\"active-slide\");return false;}}slider.animating=true;slider.animatingTo=target;if(pause)slider.pause();slider.vars.before(slider);if(slider.syncExists&&!fromNav)methods.sync(\"animate\");if(slider.vars.controlNav)methods.controlNav.active();if(!carousel)slider.slides.removeClass(namespace+'active-slide').eq(target).addClass(namespace+'active-slide');slider.atEnd=target===0||target===slider.last;if(slider.vars.directionNav)methods.directionNav.update();if(target===slider.last){slider.vars.end(slider);if(!slider.vars.animationLoop)slider.pause();}if(!fade){var dimension=(vertical)?slider.slides.filter(':first').height():slider.computedW,margin,slideString,calcNext;if(carousel){margin=slider.vars.itemMargin;calcNext=((slider.itemW+margin)*slider.move)*slider.animatingTo;slideString=(calcNext>slider.limit&&slider.visible!==1)?slider.limit:calcNext;}else if(slider.currentSlide===0&&target===slider.count-1&&slider.vars.animationLoop&&slider.direction!==\"next\"){slideString=(reverse)?(slider.count+slider.cloneOffset)*dimension:0;}else if(slider.currentSlide===slider.last&&target===0&&slider.vars.animationLoop&&slider.direction!==\"prev\"){slideString=(reverse)?0:(slider.count+1)*dimension;}else{slideString=(reverse)?((slider.count-1)-target+slider.cloneOffset)*dimension:(target+slider.cloneOffset)*dimension;}slider.setProps(slideString,\"\",slider.vars.animationSpeed);if(slider.transitions){if(!slider.vars.animationLoop||!slider.atEnd){slider.animating=false;slider.currentSlide=slider.animatingTo;}slider.container.unbind(\"webkitTransitionEnd transitionend\");slider.container.bind(\"webkitTransitionEnd transitionend\",function(){slider.wrapup(dimension);});}else{slider.container.animate(slider.args,slider.vars.animationSpeed,slider.vars.easing,function(){slider.wrapup(dimension);});}}else{if(!touch){slider.slides.eq(slider.currentSlide).css({\"zIndex\":1}).animate({\"opacity\":0},slider.vars.animationSpeed,slider.vars.easing);slider.slides.eq(target).css({\"zIndex\":2}).animate({\"opacity\":1},slider.vars.animationSpeed,slider.vars.easing,slider.wrapup);}else{slider.slides.eq(slider.currentSlide).css({\"opacity\":0,\"zIndex\":1});slider.slides.eq(target).css({\"opacity\":1,\"zIndex\":2});slider.wrapup(dimension);}}if(slider.vars.smoothHeight)methods.smoothHeight(slider.vars.animationSpeed);}}\nslider.wrapup=function(dimension){if(!fade&&!carousel){if(slider.currentSlide===0&&slider.animatingTo===slider.last&&slider.vars.animationLoop){slider.setProps(dimension,\"jumpEnd\");}else if(slider.currentSlide===slider.last&&slider.animatingTo===0&&slider.vars.animationLoop){slider.setProps(dimension,\"jumpStart\");}}slider.animating=false;slider.currentSlide=slider.animatingTo;slider.vars.after(slider);}\nslider.animateSlides=function(){if(!slider.animating&&focused)slider.flexAnimate(slider.getTarget(\"next\"));}\nslider.pause=function(){clearInterval(slider.animatedSlides);slider.animatedSlides=null;slider.playing=false;if(slider.vars.pausePlay)methods.pausePlay.update(\"play\");if(slider.syncExists)methods.sync(\"pause\");}\nslider.play=function(){if(slider.playing)clearInterval(slider.animatedSlides);slider.animatedSlides=slider.animatedSlides||setInterval(slider.animateSlides,slider.vars.slideshowSpeed);slider.started=slider.playing=true;if(slider.vars.pausePlay)methods.pausePlay.update(\"pause\");if(slider.syncExists)methods.sync(\"play\");}\nslider.stop=function(){slider.pause();slider.stopped=true;}\nslider.canAdvance=function(target,fromNav){var last=(asNav)?slider.pagingCount-1:slider.last;return(fromNav)?true:(asNav&&slider.currentItem===slider.count-1&&target===0&&slider.direction===\"prev\")?true:(asNav&&slider.currentItem===0&&target===slider.pagingCount-1&&slider.direction!==\"next\")?false:(target===slider.currentSlide&&!asNav)?false:(slider.vars.animationLoop)?true:(slider.atEnd&&slider.currentSlide===0&&target===last&&slider.direction!==\"next\")?false:(slider.atEnd&&slider.currentSlide===last&&target===0&&slider.direction===\"next\")?false:true;}\nslider.getTarget=function(dir){slider.direction=dir;if(dir===\"next\"){return(slider.currentSlide===slider.last)?0:slider.currentSlide+1;}else{return(slider.currentSlide===0)?slider.last:slider.currentSlide-1;}}\nslider.setProps=function(pos,special,dur){var target=(function(){var posCheck=(pos)?pos:((slider.itemW+slider.vars.itemMargin)*slider.move)*slider.animatingTo,posCalc=(function(){if(carousel){return(special===\"setTouch\")?pos:(reverse&&slider.animatingTo===slider.last)?0:(reverse)?slider.limit-(((slider.itemW+slider.vars.itemMargin)*slider.move)*slider.animatingTo):(slider.animatingTo===slider.last)?slider.limit:posCheck;}else{switch(special){case\"setTotal\":return(reverse)?((slider.count-1)-slider.currentSlide+slider.cloneOffset)*pos:(slider.currentSlide+slider.cloneOffset)*pos;case\"setTouch\":return(reverse)?pos:pos;case\"jumpEnd\":return(reverse)?pos:slider.count*pos;case\"jumpStart\":return(reverse)?slider.count*pos:pos;default:return pos;}}}());return(posCalc*-1)+\"px\";}());if(slider.transitions){target=(vertical)?\"translate3d(0,\"+target+\",0)\":\"translate3d(\"+target+\",0,0)\";dur=(dur!==undefined)?(dur/1000)+\"s\":\"0s\";slider.container.css(\"-\"+slider.pfx+\"-transition-duration\",dur);}slider.args[slider.prop]=target;if(slider.transitions||dur===undefined)slider.container.css(slider.args);}\nslider.setup=function(type){if(!fade){var sliderOffset,arr;if(type===\"init\"){slider.viewport=$('<div class=\"'+namespace+'viewport\"></div>').css({\"overflow\":\"hidden\",\"position\":\"relative\"}).appendTo(slider).append(slider.container);slider.cloneCount=0;slider.cloneOffset=0;if(reverse){arr=$.makeArray(slider.slides).reverse();slider.slides=$(arr);slider.container.empty().append(slider.slides);}}if(slider.vars.animationLoop&&!carousel){slider.cloneCount=2;slider.cloneOffset=1;if(type!==\"init\")slider.container.find('.clone').remove();slider.container.append(slider.slides.first().clone().addClass('clone').attr('aria-hidden','true')).prepend(slider.slides.last().clone().addClass('clone').attr('aria-hidden','true'));}slider.newSlides=$(slider.vars.selector,slider);sliderOffset=(reverse)?slider.count-1-slider.currentSlide+slider.cloneOffset:slider.currentSlide+slider.cloneOffset;if(vertical&&!carousel){slider.container.height((slider.count+slider.cloneCount)*200+\"%\").css(\"position\",\"absolute\").width(\"100%\");setTimeout(function(){slider.newSlides.css({\"display\":\"block\"});slider.doMath();slider.viewport.height(slider.h);slider.setProps(sliderOffset*slider.h,\"init\");},(type===\"init\")?100:0);}else{slider.container.width((slider.count+slider.cloneCount)*200+\"%\");slider.setProps(sliderOffset*slider.computedW,\"init\");setTimeout(function(){slider.doMath();slider.newSlides.css({\"width\":slider.computedW,\"float\":\"left\",\"display\":\"block\"});if(slider.vars.smoothHeight)methods.smoothHeight();},(type===\"init\")?100:0);}}else{slider.slides.css({\"width\":\"100%\",\"float\":\"left\",\"marginRight\":\"-100%\",\"position\":\"relative\"});if(type===\"init\"){if(!touch){slider.slides.css({\"opacity\":0,\"display\":\"block\",\"zIndex\":1}).eq(slider.currentSlide).css({\"zIndex\":2}).animate({\"opacity\":1},slider.vars.animationSpeed,slider.vars.easing);}else{slider.slides.css({\"opacity\":0,\"display\":\"block\",\"webkitTransition\":\"opacity \"+slider.vars.animationSpeed/1000+\"s ease\",\"zIndex\":1}).eq(slider.currentSlide).css({\"opacity\":1,\"zIndex\":2});}}if(slider.vars.smoothHeight)methods.smoothHeight();}if(!carousel)slider.slides.removeClass(namespace+\"active-slide\").eq(slider.currentSlide).addClass(namespace+\"active-slide\");}\nslider.doMath=function(){var slide=slider.slides.first(),slideMargin=slider.vars.itemMargin,minItems=slider.vars.minItems,maxItems=slider.vars.maxItems;slider.w=(slider.viewport===undefined)?slider.width():slider.viewport.width();slider.h=slide.height();slider.boxPadding=slide.outerWidth()-slide.width();if(carousel){slider.itemT=slider.vars.itemWidth+slideMargin;slider.minW=(minItems)?minItems*slider.itemT:slider.w;slider.maxW=(maxItems)?(maxItems*slider.itemT)-slideMargin:slider.w;slider.itemW=(slider.minW>slider.w)?(slider.w-(slideMargin*(minItems-1)))/minItems:(slider.maxW<slider.w)?(slider.w-(slideMargin*(maxItems-1)))/maxItems:(slider.vars.itemWidth>slider.w)?slider.w:slider.vars.itemWidth;slider.visible=Math.floor(slider.w/(slider.itemW));slider.move=(slider.vars.move>0&&slider.vars.move<slider.visible)?slider.vars.move:slider.visible;slider.pagingCount=Math.ceil(((slider.count-slider.visible)/slider.move)+1);slider.last=slider.pagingCount-1;slider.limit=(slider.pagingCount===1)?0:(slider.vars.itemWidth>slider.w)?(slider.itemW*(slider.count-1))+(slideMargin*(slider.count-1)):((slider.itemW+slideMargin)*slider.count)-slider.w-slideMargin;}else{slider.itemW=slider.w;slider.pagingCount=slider.count;slider.last=slider.count-1;}slider.computedW=slider.itemW-slider.boxPadding;}\nslider.update=function(pos,action){slider.doMath();if(!carousel){if(pos<slider.currentSlide){slider.currentSlide+=1;}else if(pos<=slider.currentSlide&&pos!==0){slider.currentSlide-=1;}slider.animatingTo=slider.currentSlide;}if(slider.vars.controlNav&&!slider.manualControls){if((action===\"add\"&&!carousel)||slider.pagingCount>slider.controlNav.length){methods.controlNav.update(\"add\");}else if((action===\"remove\"&&!carousel)||slider.pagingCount<slider.controlNav.length){if(carousel&&slider.currentSlide>slider.last){slider.currentSlide-=1;slider.animatingTo-=1;}methods.controlNav.update(\"remove\",slider.last);}}if(slider.vars.directionNav)methods.directionNav.update();}\nslider.addSlide=function(obj,pos){var $obj=$(obj);slider.count+=1;slider.last=slider.count-1;if(vertical&&reverse){(pos!==undefined)?slider.slides.eq(slider.count-pos).after($obj):slider.container.prepend($obj);}else{(pos!==undefined)?slider.slides.eq(pos).before($obj):slider.container.append($obj);}slider.update(pos,\"add\");slider.slides=$(slider.vars.selector+':not(.clone)',slider);slider.setup();slider.vars.added(slider);}\nslider.removeSlide=function(obj){var pos=(isNaN(obj))?slider.slides.index($(obj)):obj;slider.count-=1;slider.last=slider.count-1;if(isNaN(obj)){$(obj,slider.slides).remove();}else{(vertical&&reverse)?slider.slides.eq(slider.last).remove():slider.slides.eq(obj).remove();}slider.doMath();slider.update(pos,\"remove\");slider.slides=$(slider.vars.selector+':not(.clone)',slider);slider.setup();slider.vars.removed(slider);}\nmethods.init();}\n$(window).blur(function(e){focused=false;}).focus(function(e){focused=true;});$.flexslider.defaults={namespace:\"flex-\",selector:\".slides > li\",animation:\"fade\",easing:\"swing\",direction:\"horizontal\",reverse:false,animationLoop:true,smoothHeight:false,startAt:0,slideshow:true,slideshowSpeed:7000,animationSpeed:600,initDelay:0,randomize:false,thumbCaptions:false,pauseOnAction:true,pauseOnHover:false,pauseInvisible:true,useCSS:true,touch:true,video:false,controlNav:true,directionNav:true,prevText:\"Previous\",nextText:\"Next\",keyboard:true,multipleKeyboard:false,mousewheel:false,pausePlay:false,pauseText:\"Pause\",playText:\"Play\",controlsContainer:\"\",manualControls:\"\",sync:\"\",asNavFor:\"\",itemWidth:0,itemMargin:0,minItems:1,maxItems:0,move:0,allowOneSlide:true,start:function(){},before:function(){},after:function(){},end:function(){},added:function(){},removed:function(){}}\n$.fn.flexslider=function(options){if(options===undefined)options={};if(typeof options===\"object\"){return this.each(function(){var $this=$(this),selector=(options.selector)?options.selector:\".slides > li\",$slides=$this.find(selector);if(($slides.length===1&&options.allowOneSlide===true)||$slides.length===0){$slides.fadeIn(400);if(options.start)options.start($this);}else if($this.data('flexslider')===undefined){new $.flexslider(this,options);}});}else{var $slider=$(this).data('flexslider');switch(options){case\"play\":$slider.play();break;case\"pause\":$slider.pause();break;case\"stop\":$slider.stop();break;case\"next\":$slider.flexAnimate($slider.getTarget(\"next\"),true);break;case\"prev\":case\"previous\":$slider.flexAnimate($slider.getTarget(\"prev\"),true);break;default:if(typeof options===\"number\")$slider.flexAnimate(options,true);}}}})(jQuery);";
var mod_pagespeed_7akTnzgdAE = "var VA = {\n	models: {},\n	collections: {},\n	views: {},\n	app: {}\n};\n\nVA.models.SingleAnnotation = Backbone.Model.extend({\n\n	defaults: function() {\n		return {\n			id: 0,\n			title: 'Test Title',\n			content: 's.'\n		}\n	}\n\n});\n\nVA.collections.Annotations = Backbone.Collection.extend({\n	model: VA.models.SingleAnnotation\n});\n\nVA.views.SingleAnnotation = Backbone.View.extend({\n\n	tagName: \"div\",\n	template: _.template( jQuery( '#va-tooltip-single' ).size() ? jQuery( '#va-tooltip-single' ).html() : '' ),\n\n	attributes: {\n		class: 'va-single'\n	},\n\n	initialize: function() {\n	},\n\n	render: function() {\n\n		var t = this;\n\n		t.$el.html( this.template( t.model.toJSON() ) );\n\n		return this;\n	}\n\n});\n\nVA.views.AnnotationTooltip = Backbone.View.extend({\n\n	annotations: {},\n	tagName: \"div\",\n	template: _.template( jQuery( '#va-tooltip' ).size() ? jQuery( '#va-tooltip' ).html() : '' ),\n\n	attributes: {\n		class: 'va-tooltip-container closed'\n	},\n\n	events: {\n		'click .va-tooltip-toggle': 'toggleTooltip',\n		'click .va-annotation' : 'showTooltipForAnnotation',\n		'click .va-tooltip-share button': 'share'\n	},\n\n	initialize: function() {\n		this.annotations = new VA.collections.Annotations;\n	},\n\n	activeAnnotation: 0,\n\n	render: function() {\n\n		var t = this;\n\n		t.$el.html( this.template({}) );\n		t.$tooltip = t.$el.find( '.va-tooltip' ); // store reference to the tooltip element.\n		t.$tooltipBody = t.$el.find( '.va-tooltip-body' ); // store reference to the tooltip element.\n		t.$tooltip.hide();\n\n		t.annotations.each( function( annotation ) {\n			var view = new VA.views.SingleAnnotation({ model: annotation });\n			t.$tooltipBody.append( view.render().el );\n		} );\n\n		if ( t.annotations.length > 1 ) {\n			t.initCarousel();\n		}\n\n		// After everything is loaded, maybe show current hash annotation.\n		jQuery( window ).load( function() {\n			var hashAnnotation = window.location.hash.match(/^#va-(\\d+)$/);\n			if ( hashAnnotation ) {\n				var model = t.annotations.findWhere( { id: parseInt( hashAnnotation[1] ) } );\n				if ( model ) {\n					var position = t.annotations.indexOf( model );\n					t.toggleTooltip( 0, position );\n				}\n			}\n		} );\n\n\n		t.$annotationText = t.$el.find( '.va-annotation' );\n\n		jQuery( document ).on( 'click touchstart', function( e ) {\n\n			if ( jQuery( e.target ).hasClass( 'va-annotation' ) || jQuery( e.target ).closest( '.va-tooltip' ).length > 0 ) {\n				return;\n			}\n\n			if ( t.$el.hasClass( 'open' ) ) {\n				t.toggleTooltip();\n			}\n		});\n\n\n		return this;\n	},\n\n	setPosition: function( annotationIndex ) {\n		var t = this;\n\n		// Re-set positioning when any images are loaded.\n		t.$el.find( 'img,iframe' ).on( 'load', _.debounce( function() {\n			t.setPosition(annotationIndex);\n		}, 300 ) );\n		t.$tooltip.show( 0, function() {\n\n			t.updatePosition( annotationIndex );\n\n			t.$tooltip.hide( 0 );\n\n		});\n	},\n\n	updatePosition: function( annotationIndex ) {\n		if( this.$tooltip.hasClass( 'fadeOutDown' ) ) {\n			this.$tooltip.toggleClass( 'fadeOutDown' );\n		}\n		var t = this;\n\n		var $markerEl = jQuery( t.annotations.at( annotationIndex ).get( 'markerEl' ) );\n		var $header = t.$( '.primary-header-wrap' );\n\n		// If desktop, make sure tooltip doesnt overflow content area and become unusable\n		if ( ( 'matchMedia' in window ) && window.matchMedia( \"(max-width: 720px)\" ).matches ) {\n\n			var maxHeight = window.innerHeight ? window.innerHeight : jQuery(window).height();\n			maxHeight = maxHeight - t.$tooltip.find( '.va-tooltip-header' ).outerHeight();\n			maxHeight = maxHeight - t.$tooltip.find( '.va-tooltip-footer' ).outerHeight();\n			t.$tooltip.find( '.va-single' ).css( 'max-height', maxHeight );\n\n		} else {\n\n			var maxHeight = $markerEl.offset().top - 40; /* Top of container, minus 40px margin */\n			maxHeight = maxHeight - t.$el.closest( '.content' ).offset().top; /* Minus position of content container from top of page (easy way to get header height) */\n			maxHeight = maxHeight - t.$tooltip.find( '.va-tooltip-header' ).outerHeight();\n			maxHeight = maxHeight - t.$tooltip.find( '.va-tooltip-footer' ).outerHeight();\n\n			if ( maxHeight > 330 ) {\n				maxHeight = 330;\n			}\n\n			t.$tooltip.find( '.va-single' ).css( 'max-height', maxHeight );\n		}\n\n		// Get position of markerEl relative to container.\n		var tooltip_width = jQuery( t.$tooltip.find( '.va-single' )[0] ).width();\n		var parent = $markerEl.parent();\n		var left_offset = ( parent.width() - tooltip_width )/2;\n		var xPos = parent.offset().left + left_offset;\n		var yPos = parent.top - 10;\n		t.$tooltip.offset( {left: xPos, top: yPos} );\n		t.$tooltip.css( 'margin-top', -1 * t.$tooltip.outerHeight() - 20 );\n	},\n\n	showTooltipForAnnotation: function( e ) {\n		e.preventDefault();\n\n		var $el        = jQuery( e.target );\n		var annotation = this.annotations.findWhere( { id: jQuery( e.target ).data( 'id' ) } );\n		var position   = this.annotations.indexOf( annotation );\n		var speed      = 250;\n		var y          = $el.position().left + ( $el.width() / 2 );\n\n		var t = this;\n\n		t.activeAnnotation = position;\n\n		// Loop through and hide all the other tooltips.\n		for ( var i = 0; i < VA.app.tooltips.length; i++ ) {\n			if ( VA.app.tooltips[i] !== this ) {\n				VA.app.tooltips[i].$tooltip.fadeOut( speed );\n				VA.app.tooltips[i].$el.toggleClass( 'closed', true ).toggleClass( 'open', false );\n			}\n		}\n\n		t.$( t.annotations.at( t.activeAnnotation ).get( 'markerEl' ) ).addClass( 'active' );\n\n		this.$el.removeClass( 'closed' ).addClass( 'open' );\n		this.$tooltip.fadeIn( speed );\n\n		this.$tooltip.css( 'left', y + 'px' );\n\n		t.updatePosition( position );\n\n		if ( this.$tooltipBody.data( 'flexslider' ) ) {\n			this.$tooltipBody.flexslider( position );\n		}\n\n		if ( this.$tooltip.css( 'position' ) !== 'fixed' ) {\n			this.scrollToTooltip();\n		}\n\n	},\n\n	toggleTooltip: function( speed, position ) {\n\n		var t = this;\n\n		if ( position ) {\n			t.activeAnnotation = position;\n		}\n\n		if ( ! speed ) {\n			speed = 250;\n		}\n\n		// Loop through and hide all the other tooltips.\n		for ( var i = 0; i < VA.app.tooltips.length; i++ ) {\n			if ( VA.app.tooltips[i] !== this ) {\n				VA.app.tooltips[i].$tooltip.fadeOut( speed );\n				VA.app.tooltips[i].$el.toggleClass( 'closed', true ).toggleClass( 'open', false );\n			}\n		}\n\n		var isOpen = this.$el.hasClass( 'open' );\n\n		if ( isOpen ) {\n			t.$el.find( '.va-annotation' ).removeClass( 'active' );\n		} else {\n			t.$( t.annotations.at( t.activeAnnotation ).get( 'markerEl' ) ).addClass( 'active' );\n		}\n\n		this.$tooltip.toggleClass( 'fadeOutDown' );\n		this.$el.toggleClass( 'closed' ).toggleClass( 'open' );\n		if( this.$el.hasClass('closed') ) {\n			speed = 400;\n		}\n		this.$tooltip.fadeToggle( speed );\n		if ( position ) {\n			this.$tooltipBody.flexslider( position );\n		}\n\n		if ( ! isOpen && this.$tooltip.css( 'position' ) !== 'fixed' ) {\n			this.scrollToTooltip();\n		}\n	},\n\n	scrollToTooltip: function() {\n		if ( jQuery( window ).scrollTop() + 60 > this.$tooltip.offset().top || this.$tooltip.offset().top + this.$tooltip.height() > jQuery( window ).scrollTop() + 60 + jQuery( window).height()  ) {\n			jQuery( 'html,body' ).animate( { scrollTop: this.$tooltip.offset().top - 120 }, 500 );\n		}\n	},\n\n	/**\n	 * Initialize the Carousel.\n	 * Note that to do this - we must first show the carousel. Then initialize. Then hide. All very quickly.\n	 */\n	initCarousel: function() {\n\n		var t = this;\n\n		t.$tooltipBody.flexslider({\n			selector: \".va-single\",\n			slideshow: false,\n			directionNav: false,\n			after: function(slider) {\n				t.activeAnnotation = slider.currentSlide;\n			},\n			before: function( flexslider ) {\n				t.$el.find( '.va-annotation' ).removeClass( 'active' );\n				t.$( t.annotations.at( flexslider.animatingTo ).get( 'markerEl' ) ).addClass( 'active' );\n			}\n		});\n	},\n\n	share: function(e) {\n\n		var t = this, share = {};\n\n		if ( t.annotations.length > 1 ) {\n			share.currentSlide = t.$tooltipBody.data( 'flexslider' ).currentSlide;\n			share.currentAnnotation = t.annotations.at( share.currentSlide );\n		} else {\n			share.currentAnnotation = t.annotations.at(0);\n		}\n\n		share.type = jQuery( e.currentTarget ).attr( 'data-type' );\n		share.title = share.currentAnnotation.get( 'title' );\n		share.content = share.currentAnnotation.get( 'content' );\n		share.currentURL = VAshortlink + '#va-' + share.currentAnnotation.get( 'id' );\n\n		switch ( share.type ) {\n\n			case 'twitter':\n\n				var api_url = \"https://twitter.com/intent/tweet\";\n\n				var twitter_title = share.title;\n				var word_count = ( share.title + \" \" + ( share.currentURL.length > 20 ? share.currentURL.substr(0, 19 ) : share.currentURL ) +\" via @vocativ\" ).length;\n\n				if ( word_count > 140 ) {\n					twitter_title = share.title.substr( 0, share.title.length - ( word_count - 140 ) - 3 ) + '...';\n				}\n\n				share.url = api_url +\n					\"?url=\"+ encodeURIComponent( share.currentURL ) +\n					\"&text=\" + encodeURIComponent( twitter_title ) +\n					\"&related=vocativ\" +\n					\"&via=vocativ\";\n				break;\n\n			case 'facebook':\n\n				var api_url = 'https://www.facebook.com/dialog/feed';\n\n				// Grab the first picture.\n				var picture;\n				picture = jQuery( share.content ).find( 'img' );\n				if ( picture.length > 0 ) {\n					picture = picture.eq(0).attr( 'src' );\n				}\n				else {\n					picture = '';\n				}\n\n				share.url = api_url +\n					\"?app_id=\" + encodeURIComponent( VocativTheme.facebook_app_id ) +\n					\"&redirect_uri=\" + encodeURIComponent( VocativTheme.home_url + '?shared=facebook' ) +\n					\"&link=\" + encodeURIComponent( share.currentURL ) +\n					\"&display=popup\" +\n					\"&name=\" + encodeURIComponent( share.title ) +\n					\"&description=\" + encodeURIComponent( share.content ) +\n					\"&picture=\" + encodeURIComponent( picture )\n				break;\n\n			case 'tumblr':\n\n				var api_url = 'http://www.tumblr.com/share/link';\n				share.url = api_url +\n						   \"?url=\" + encodeURIComponent( share.currentURL ) +\n						   \"&name=\" + encodeURIComponent( share.title ) +\n						   \"&description=\" + encodeURIComponent( share.content );\n\n				break;\n\n		}\n\n		share.position = {};\n		share.position.width        = 575;\n		share.position.height       = 440;\n		share.position.left         = ( jQuery(window).width()  - share.position.width )  / 2;\n		share.position.top          = ( jQuery(window).height() - share.position.height ) / 2;\n\n		share.opts = 'status=1' +\n				   ',width='  + share.position.width  +\n				   ',height=' + share.position.height +\n				   ',top='    + share.position.top    +\n				   ',left='   + share.position.left;\n\n		window.open( share.url, '_blank', share.opts );\n\n		// Clear focus on the button.\n		t.$(e.currentTarget).blur();\n	}\n\n\n});\n\njQuery(document).ready( function() {\n\n	var t = this;\n\n	t.$contentContainer = jQuery( '.article-content' );\n	t.annotations       = [];\n\n	t.$contentContainer.children().each( function( i, childEl ) {\n\n		var annotations = [];\n\n		jQuery(childEl).find( '.va-annotation' ).each( function( i, markerEl ) {\n\n			if ( 'undefined' === typeof window.VAdata ) {\n				return;\n			}\n\n			var annotationId = jQuery(markerEl).attr( 'data-id' );\n\n			var annotation = VAdata.filter( function( annotation ) {\n				return annotation.id == annotationId;\n			} )[0];\n\n			if ( ! annotation ) {\n				return;\n			}\n\n			annotation.markerEl = markerEl,\n			annotation.parent = childEl\n\n			annotations.push(annotation)\n\n		} );\n\n		if ( annotations.length < 1 ) {\n			return;\n		}\n\n		if ( ! ( 'tooltips' in VA.app ) ) {\n			VA.app.tooltips = [];\n		}\n\n		var tooltip = new VA.views.AnnotationTooltip();\n\n		VA.app.tooltips.push( tooltip );\n\n		tooltip.annotations.reset(annotations);\n\n		jQuery(childEl).after( tooltip.render().el );\n		jQuery(childEl).appendTo( tooltip.$el );\n\n	} );\n} );";
var mod_pagespeed_Bt3DxRAzgD = "var $=jQuery;jQuery(document).ready(function(){window.VocativEmbeddedGalleryViewList={};initVocativGallery();var browser_is_ie=!!navigator.userAgent.match(/MSIE /)||!!navigator.userAgent.match(/Trident.*rv[ :]*11\\./);if(!browser_is_ie&&!jQuery.isEmptyObject(window.VocativEmbeddedGalleryViewList)){for(key in window.VocativEmbeddedGalleryViewList){var view=window.VocativEmbeddedGalleryViewList[key];break;}var title=jQuery(document).attr('title');var current_url=[jQuery(document).attr('location').origin,jQuery(document).attr('location').pathname,jQuery(document).attr('location').search,jQuery(document).attr('location').hash].join('');window.history.pushState({model_id:view.model.id,pointer:view.model.get('pointer')},title,current_url);}var first_load=true;jQuery(window).bind('popstate',function(event){if(browser_is_ie||jQuery.isEmptyObject(window.VocativEmbeddedGalleryViewList)){return;}var state=event.originalEvent.state;if(!state&&!first_load){history.back();}first_load=false;if(state&&state.model_id){var view=window.VocativEmbeddedGalleryViewList[state.model_id];view.model.setPointer(state.pointer);}});});function initVocativGallery(){$('.post-item-type-image .fullscreen').bind('touchstart click',function(e){e.preventDefault();jQuery(this).parents('.post-item-type').removeClass('share-section-open');var pointer=$('.post-item-type-image .fullscreen').index(this);var gallery=new VocativGallery({images:VocativImagePostItemsGallery['images']});gallery.setPointer(pointer);var tracker=undefined;if(typeof VocativTracking!='undefined'){tracker=VocativTracking.getGalleryTracker(VocativTracking.itemsCategory);}var galleryView=new VocativGalleryView({model:gallery,tracker:tracker});$('body').append(galleryView.$el);galleryView.render();galleryView.trigger('open');});if($('.post-item-type.post-item-type-gallery').length>0){var galleries=[];$('.post-item-type.post-item-type-gallery').each(function(){var $el=$(this).find('.gallery-view');if($el.data('gellery-init'))return;var gallery=new VocativGallery(window[$el.data('gallery-var')]);galleries.push(gallery);gallery.set({sharing:$el.find('.gallery-share').html()});var mainGallery=$el.parents('.gallery-article-main-gallery').length;gallery.set({mainGallery:mainGallery});var tracker=undefined;if(typeof VocativTracking!='undefined'){var trackingCategory=mainGallery?VocativTracking.galleryMainCategory:VocativTracking.galleryEmbeddedCategory;tracker=VocativTracking.getGalleryTracker(trackingCategory);}var galleryEmbeddedView=new VocativGalleryEmbeddedView({model:gallery,el:$el.find('.gallery-embedded-view').get(0),tracker:tracker});galleryEmbeddedView.render();window.VocativEmbeddedGalleryViewList[gallery.id.toString()]=galleryEmbeddedView;var galleryThumbView=new VocativGalleryThumbView({model:gallery,el:$el.find('.gallery-thumbnails').get(0),tracker:tracker});galleryThumbView.render();$el.data('gellery-init',true);});if(galleries.length>0){jQuery.ajax({url:VocativTheme.cdn_ajax_url,xhrFields:{withCredentials:true},data:{action:'vocativ_get_gallery_postwatch'},success:function(response){if(response&&response.data&&response.data.length){var postWatch=new VocativGalleryGalleries;_.each(response.data,function(galleryData){postWatch.add(new VocativGallery(galleryData));});postWatch.each(function(gallery){gallery.set({postWatch:postWatch});});_.each(galleries,function(gallery){gallery.set({postWatch:postWatch});});}}});}}}";
